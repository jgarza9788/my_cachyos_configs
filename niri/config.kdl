//---------------------- cursor ----------------------\\
cursor {
    //Look in /home/jgarza/.icons
    //xcursor-theme "Bibata-Modern-Ice"
    xcursor-theme "DeppinDark-cursors" 

    xcursor-size 64
}


//---------------------- input ----------------------\\
input {
    keyboard {
        xkb {
            layout "us"
        }
    }
    touchpad {
        tap
        natural-scroll
    }
    mouse {
        // off
        // natural-scroll
        //accel-speed 0.0
        //accel-profile "flat"
        //scroll-method "no-scroll"
        accel-speed -0.5
        accel-profile "adaptive"
    }

    focus-follows-mouse

    // Uncomment this to make the mouse warp to the center of newly focused windows.
    //warp-mouse-to-focus

    // Focus windows and outputs automatically when moving the mouse into them.
    // Setting max-scroll-amount="0%" makes it work only on windows already fully on screen.
    //focus-follows-mouse max-scroll-amount="0%"
}


//---------------------- monitor ----------------------\\
output "eDP-1" {
    mode "1920x1080@59.951"
    scale 1
    position x=1280 y=0
    variable-refresh-rate // on-demand=true
    focus-at-startup
    backdrop-color "#001100"
}


//---------------------- decoration ----------------------\\
layout {
    gaps 24
    always-center-single-column
    center-focused-column "never"

    preset-column-widths {
        proportion 0.33333
        proportion 0.5
        proportion 0.66667
        proportion 1.0
    }
    preset-window-heights {
        proportion 0.33333
        proportion 0.5
        proportion 0.66667
        proportion 1.0
    }
    default-column-width { proportion 0.5; }
    focus-ring {
        width 3
        active-color "#d3d8d8"
        inactive-color "#909292"
    }
    border {
        off
    }
    struts {
        left 0
        right 0
        top 0
        bottom 0
    }
    background-color "transparent"

}


//---------------------- startup ----------------------\\
spawn-at-startup "waybar"
spawn-at-startup "swaync"
spawn-sh-at-startup "wl-paste --watch cliphist store"
spawn-sh-at-startup "sh ~/.config/niri/scripts/startup.sh"
spawn-sh-at-startup "sh ~/.config/niri/scripts/polkit.sh"



//---------------------- layer rules ----------------------\\
layer-rule {
    match namespace="^swww-daemon$"
    place-within-backdrop true
}


//---------------------- animations ----------------------\\
animations {
    // Nudge everything a hair slower for a smooth feel (values <1 speed up).
    slowdown 2.0   // docs show global off/slowdown knobs

    workspace-switch {
        spring damping-ratio=1.0 stiffness=1000 epsilon=0.0001
    }

    window-open {
        duration-ms 150
        curve "ease-out-expo"
    }

    window-close {
        duration-ms 150
        curve "ease-out-quad"
    }

    horizontal-view-movement {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }

    window-movement {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }

    window-resize {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }

    config-notification-open-close {
        spring damping-ratio=0.6 stiffness=1000 epsilon=0.001
    }

    exit-confirmation-open-close {
        spring damping-ratio=0.6 stiffness=500 epsilon=0.01
    }

    screenshot-ui-open {
        duration-ms 200
        curve "ease-out-quad"
    }

    overview-open-close {
        spring damping-ratio=1.0 stiffness=800 epsilon=0.0001
    }
}

overview {
	zoom 0.30
	//backdrop-color "#263238"
    backdrop-color "#000000ff"
}

//---------------------- window rules ----------------------\\
window-rule {
    geometry-corner-radius 8
    clip-to-geometry true
}

window-rule {
    match app-id="firefox"
    match app-id="code"
    match app-id="dev.zed.Zed"
    default-column-width { proportion 1.0; }
}

window-rule {
    match app-id="kitty" title="browser"
    match app-id="kitty" title="monitor"
    match app-id="kitty" title="update"
    open-floating true
    shadow {
        on
    }
}

window-rule {
    open-floating false
    // open-maximized true
}

window-rule {
    match app-id=r#"^org\.wezfurlong\.wezterm$"#
    default-column-width {}
}

window-rule {
    draw-border-with-background false
}

window-rule {
    match app-id=r#"^org\.kde\.kdeconnect\.daemon$"#
    match app-id=r#"^galculator$"#
    open-floating true
}

window-rule {
    match app-id=r#"org.kde.polkit-kde-authentication-agent-1"#
    block-out-from "screen-capture"
    // block-out-from "screencast"
}

window-rule {
    match app-id=r#"zen$"# title="^Picture-in-Picture$"
    open-floating true
}

window-rule {
    match app-id=r#"zen$"#
    match app-id=r#"chromium$"#
    default-column-width {proportion 0.9;}
}

window-rule {
    match app-id=r#"neovide$"#
    match app-id=r#"zed$"#
    match app-id=r#"jetbrains-idea$"#
    match app-id=r#"codium"#
    
    default-column-width {proportion 0.75;}
}

window-rule {
    match app-id=r#"org.pwmt.zathura"#
    default-column-width {proportion 0.66667;}
}

window-rule {
    match app-id=r#"QtScrcpy$"# title="^Phone-+"
    default-column-width {proportion 0.25;}
}

window-rule {
    match app-id=r#"QtScrcpy$"# title="^Tool$"
    open-floating false
    default-column-width {}
}

window-rule {
    geometry-corner-radius 5
    clip-to-geometry true
}




//---------------------- keybinds ----------------------\\
binds {

    //// applications
    //Mod+Return           { spawn-sh "kitty"; }
    //Mod+D                { spawn-sh "~/.config/niri/scripts/menu.sh"; }
    //Mod+Shift+D          { spawn-sh "~/.config/niri/scripts/rofi-emoji.sh"; }
    //Mod+E                { spawn-sh "dolphin"; }
    //Mod+B                { spawn-sh "~/.config/niri/scripts/browser.sh"; }
    //Mod+Alt+B            { spawn-sh "~/.config/niri/scripts/default_browser.sh"; }
    //Mod+Shift+Slash      { show-hotkey-overlay; }
    //Mod+Shift+Backspace  { spawn "hyprlock"; }
//
    //// Backlight and Audio
    //F4                    allow-when-locked=true { spawn-sh "~/.config/niri/scripts/brightness.sh up" ; }
    //F3                    allow-when-locked=true { spawn-sh "~/.config/niri/scripts/brightness.sh down" ; }
    //F9                    allow-when-locked=true { spawn-sh "~/.config/niri/scripts/volumecontrol.sh --toggle"; }
    //F10                   allow-when-locked=true { spawn-sh "~/.config/niri/scripts/volumecontrol.sh --dec"; }
    //F11                   allow-when-locked=true { spawn-sh "~/.config/niri/scripts/volumecontrol.sh --inc"; }
//
    //XF86MonBrightnessUp   allow-when-locked=true { spawn-sh "~/.config/niri/scripts/brightness.sh up" ; }
    //XF86MonBrightnessDown allow-when-locked=true { spawn-sh "~/.config/niri/scripts/brightness.sh down" ; }
    //XF86AudioRaiseVolume  allow-when-locked=true { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.05+"; }
    //XF86AudioLowerVolume  allow-when-locked=true { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.05-"; }
    //XF86AudioMute         allow-when-locked=true { spawn-sh "wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle"; }
    //XF86AudioPlay         allow-when-locked=true { spawn-sh "playerctl play-pause"; }
    //XF86AudioPause        allow-when-locked=true { spawn-sh "playerctl pause"; }
    //XF86AudioNext         allow-when-locked=true { spawn-sh "playerctl next"; }
    //XF86AudioPrev         allow-when-locked=true { spawn-sh "playerctl previous"; }
//
    //// Windows and Columns
    //Mod+Q                { close-window; }
    //Mod+X                { spawn-sh "wlogout -b 4 --layout ~/.config/wlogout/layout --css ~/.config/wlogout/style.css"; }
    //Mod+Alt+C            { spawn-sh "~/.config/niri/scripts/cliphist.sh c"; }
    //Mod+Alt+W            { spawn-sh "~/.config/niri/scripts/cliphist.sh w"; }
    //Mod+V                { toggle-window-floating; }
    //Mod+F                { maximize-column; }
    //Mod+Shift+F          { fullscreen-window; }
    //Mod+H                { focus-column-left; }
    //Mod+L                { focus-column-right; }
    //Mod+J                { focus-window-down; }
    //Mod+K                { focus-window-up; }
    //Mod+Ctrl+H           { move-column-left; }
    //Mod+Ctrl+L           { move-column-right; }
    //Mod+Ctrl+J           { move-window-down; }
    //Mod+Ctrl+K           { move-window-up; }
    //Mod+Home             { focus-column-first; }
    //Mod+End              { focus-column-last; }
    //Mod+Ctrl+Home        { move-column-to-first; }
    //Mod+Ctrl+End         { move-column-to-last; }
    //Mod+Shift+h          { set-column-width "-10%"; }
    //Mod+Shift+l          { set-column-width "+10%"; }
    //Mod+Shift+k          { set-window-height "-10%"; }
    //Mod+Shift+j          { set-window-height "+10%"; }
    //Mod+BracketLeft      { consume-or-expel-window-left; }
    //Mod+BracketRight     { consume-or-expel-window-right; }
    //Mod+Comma            { consume-window-into-column; }
    //Mod+Period           { expel-window-from-column; }
    //Ctrl+Escape          { spawn-sh "~/.config/niri/scripts/waybar-reload.sh --reload"; }
//
    //// wallpapers
    //Mod+W                { spawn-sh "~/.config/niri/scripts/Wallpaper.sh"; }
    //Mod+Shift+W          { spawn-sh "~/.config/niri/scripts/WallpaperSelect.sh thm1"; }
//
    //// Workspaces
    //Mod+Page_Down        { focus-workspace-down; }
    //Mod+Page_Up          { focus-workspace-up; }
    //Mod+Ctrl+Page_Down   { move-column-to-workspace-down; }
    //Mod+Ctrl+Page_Up     { move-column-to-workspace-up; }
    //Mod+1                { focus-workspace 1; }
    //Mod+2                { focus-workspace 2; }
    //Mod+3                { focus-workspace 3; }
    //Mod+4                { focus-workspace 4; }
    //Mod+5                { focus-workspace 5; }
    //Mod+6                { focus-workspace 6; }
    //Mod+7                { focus-workspace 7; }
    //Mod+8                { focus-workspace 8; }
    //Mod+9                { focus-workspace 9; }
    //Mod+Ctrl+1           { move-column-to-workspace 1; }
    //Mod+Ctrl+2           { move-column-to-workspace 2; }
    //Mod+Ctrl+3           { move-column-to-workspace 3; }
    //Mod+Ctrl+4           { move-column-to-workspace 4; }
    //Mod+Ctrl+5           { move-column-to-workspace 5; }
    //Mod+Ctrl+6           { move-column-to-workspace 6; }
    //Mod+Ctrl+7           { move-column-to-workspace 7; }
    //Mod+Ctrl+8           { move-column-to-workspace 8; }
    //Mod+Ctrl+9           { move-column-to-workspace 9; }
    //Mod+Ctrl+0           { move-column-to-workspace 10; }
    //Mod+A                { toggle-overview; }
//
    // Screenshots
    //Print                { screenshot-screen; }
    //Shift+Print          { screenshot; }
    //Ctrl+Print           { screenshot-window; }

//####################################################################################

// Help / overlay
Mod+Shift+Slash { show-hotkey-overlay; }

// Terminal
//Mod+T  { spawn "alacritty"; }
Mod+T  { spawn "kitty"; }

// Lock screen
Super+Alt+L  { spawn "swaylock-fancy"; }

// Accessibility / system toggles
Super+Alt+S allow-when-locked=true hotkey-overlay-title=null { spawn-sh "pkill orca || exec orca"; }

// Media keys
XF86AudioRaiseVolume allow-when-locked=true { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.1+"; }
XF86AudioLowerVolume allow-when-locked=true { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.1-"; }
XF86AudioMute        allow-when-locked=true { spawn-sh "wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle"; }
XF86AudioMicMute     allow-when-locked=true { spawn-sh "wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle"; }

// Brightness
XF86MonBrightnessUp allow-when-locked=true { spawn "brightnessctl" "--class=backlight" "set" "+10%"; }
XF86MonBrightnessDown allow-when-locked=true { spawn "brightnessctl" "--class=backlight" "set" "10%-"; }

// Overview / window ops
Mod+O repeat=false { toggle-overview; }
Mod+Q repeat=false { close-window; }

// Focus (columns/windows/workspaces)
Mod+Left  { focus-column-left; }
Mod+Right { focus-column-right; }
Mod+Down  { focus-workspace-down; }
Mod+Up    { focus-workspace-up; }
Mod+H     { focus-column-left; }
Mod+J     { focus-window-down; }
Mod+K     { focus-window-up; }
Mod+L     { focus-column-right; }

// Move (columns/windows)
Mod+Ctrl+Left  { move-column-left; }
//Mod+Ctrl+Down  { move-window-down; }
//Mod+Ctrl+Up    { move-window-up; }
Mod+Ctrl+Down  { move-column-to-workspace-down;  }
Mod+Ctrl+Up    { move-column-to-workspace-up;  }
Mod+Ctrl+Right { move-column-right; }
Mod+Ctrl+H     { move-column-left; }
Mod+Ctrl+J     { move-window-down; }
Mod+Ctrl+K     { move-window-up; }
Mod+Ctrl+L     { move-column-right; }

// Column navigation
Mod+Home { focus-column-first; }
Mod+End  { focus-column-last; }
Mod+Ctrl+Home { move-column-to-first; }
Mod+Ctrl+End  { move-column-to-last; }

// Monitor focus/move
Mod+Shift+Left  { focus-monitor-left; }
Mod+Shift+Down  { focus-monitor-down; }
Mod+Shift+Up    { focus-monitor-up; }
Mod+Shift+Right { focus-monitor-right; }
Mod+Shift+H     { focus-monitor-left; }
Mod+Shift+J     { focus-monitor-down; }
Mod+Shift+K     { focus-monitor-up; }
Mod+Shift+L     { focus-monitor-right; }

Mod+Shift+Ctrl+Left  { move-column-to-monitor-left; }
Mod+Shift+Ctrl+Down  { move-column-to-monitor-down; }
Mod+Shift+Ctrl+Up    { move-column-to-monitor-up; }
Mod+Shift+Ctrl+Right { move-column-to-monitor-right; }
Mod+Shift+Ctrl+H     { move-column-to-monitor-left; }
Mod+Shift+Ctrl+J     { move-column-to-monitor-down; }
Mod+Shift+Ctrl+K     { move-column-to-monitor-up; }
Mod+Shift+Ctrl+L     { move-column-to-monitor-right; }
// Mod+Shift+Ctrl+Left  { move-window-to-monitor-left; }
// Mod+Shift+Ctrl+Left  { move-workspace-to-monitor-left; }

// Workspace focus/move
Mod+Page_Down      { focus-workspace-down; }
Mod+Page_Up        { focus-workspace-up; }
Mod+U              { focus-workspace-down; }
Mod+I              { focus-workspace-up; }

Mod+Ctrl+Page_Down { move-column-to-workspace-down; }
Mod+Ctrl+Page_Up   { move-column-to-workspace-up; }
Mod+Ctrl+U         { move-column-to-workspace-down; }
Mod+Ctrl+I         { move-column-to-workspace-up; }
// Mod+Ctrl+Page_Down { move-window-to-workspace-down; }

Mod+Shift+Page_Down { move-workspace-down; }
Mod+Shift+Page_Up   { move-workspace-up; }
Mod+Shift+U         { move-workspace-down; }
Mod+Shift+I         { move-workspace-up; }

// Scroll bindings
Mod+WheelScrollDown      cooldown-ms=150 { focus-workspace-down; }
Mod+WheelScrollUp        cooldown-ms=150 { focus-workspace-up; }
Mod+Ctrl+WheelScrollDown cooldown-ms=150 { move-column-to-workspace-down; }
Mod+Ctrl+WheelScrollUp   cooldown-ms=150 { move-column-to-workspace-up; }

Mod+WheelScrollRight      { focus-column-right; }
Mod+WheelScrollLeft       { focus-column-left; }
Mod+Ctrl+WheelScrollRight { move-column-right; }
Mod+Ctrl+WheelScrollLeft  { move-column-left; }

Mod+Shift+WheelScrollDown      { focus-column-right; }
Mod+Shift+WheelScrollUp        { focus-column-left; }
Mod+Ctrl+Shift+WheelScrollDown { move-column-right; }
Mod+Ctrl+Shift+WheelScrollUp   { move-column-left; }
// Mod+TouchpadScrollDown { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.02+"; }
// Mod+TouchpadScrollUp   { spawn-sh "wpctl set-volume @DEFAULT_AUDIO_SINK@ 0.02-"; }

// Direct workspace indices
Mod+1 { focus-workspace 1; }
Mod+2 { focus-workspace 2; }
Mod+3 { focus-workspace 3; }
Mod+4 { focus-workspace 4; }
Mod+5 { focus-workspace 5; }
Mod+6 { focus-workspace 6; }
Mod+7 { focus-workspace 7; }
Mod+8 { focus-workspace 8; }
Mod+9 { focus-workspace 9; }
Mod+Ctrl+1 { move-column-to-workspace 1; }
Mod+Ctrl+2 { move-column-to-workspace 2; }
Mod+Ctrl+3 { move-column-to-workspace 3; }
Mod+Ctrl+4 { move-column-to-workspace 4; }
Mod+Ctrl+5 { move-column-to-workspace 5; }
Mod+Ctrl+6 { move-column-to-workspace 6; }
Mod+Ctrl+7 { move-column-to-workspace 7; }
Mod+Ctrl+8 { move-column-to-workspace 8; }
Mod+Ctrl+9 { move-column-to-workspace 9; }
// Mod+Ctrl+1 { move-window-to-workspace 1; }
// Mod+Tab { focus-workspace-previous; }

// Column consume/expel + tabbing
Mod+BracketLeft  { consume-or-expel-window-left; }
Mod+BracketRight { consume-or-expel-window-right; }
Mod+Comma  { consume-window-into-column; }
Mod+Period { expel-window-from-column; }
Mod+W { toggle-column-tabbed-display; }

// Layout / sizing
Mod+R { switch-preset-column-width; }
// Mod+R { switch-preset-column-width-back; }
Mod+Shift+R { switch-preset-window-height; }
Mod+Ctrl+R { reset-window-height; }
Mod+F { maximize-column; }
Mod+Shift+F { fullscreen-window; }
Mod+Ctrl+F { expand-column-to-available-width; }
Mod+C { center-column; }
Mod+Ctrl+C { center-visible-columns; }
Mod+Minus { set-column-width "-10%"; }
Mod+Equal { set-column-width "+10%"; }
Mod+Shift+Minus { set-window-height "-10%"; }
Mod+Shift+Equal { set-window-height "+10%"; }
// Mod+Space       { switch-layout "next"; }
// Mod+Shift+Space { switch-layout "prev"; }

// Floating
Mod+P       { toggle-window-floating; }
Mod+Shift+P { switch-focus-between-floating-and-tiling; }

// Screenshots
Print { screenshot; }
Ctrl+Print { screenshot-screen; }
Alt+Print { screenshot-window; }

// Inhibit keyboard shortcuts
Mod+Escape allow-inhibiting=false { toggle-keyboard-shortcuts-inhibit; }

// Quit / power
Mod+Shift+E { quit; }
Ctrl+Alt+Delete { quit; }
//Mod+Shift+P { power-off-monitors; }

// Launchers
//Mod+D  { spawn "fuzzel"; }
//Mod+Space  { spawn "fuzzel"; }
//Mod+D { spawn "wofi" "--show" "drun";}
//Mod+Space { spawn "wofi" "--show" "drun";}
//Mod+Space { spawn "rofi" "-show" "drun";}
Mod+D       { spawn "~/.config/rofi/scripts/srofi.sh";}
Mod+Space   { spawn "~/.config/rofi/scripts/srofi.sh";}
//Mod+D       { spawn "~/.config/wofi/scripts/swofi.sh";}
//Mod+Space   { spawn "~/.config/wofi/scripts/swofi.sh";}

// Clipboard
//Mod+V { spawn "cliphist list | wofi --dmenu | cliphist decode | wl-copy"; }
Mod+V  { spawn "~/.config/rofi/scripts/clipboard.sh";}
//Mod+V  { spawn "~/.config/wofi/scripts/wofi-clip.sh";}

// Web apps
Mod+A  { spawn "~/.config/niri/scripts/webApp.sh" "https://chatgpt.com/";}
Mod+M  { spawn "~/.config/niri/scripts/webApp.sh" "https://gmail.com/";}

//// wallpapers
//Mod+W                { spawn-sh "~/.config/niri/scripts/Wallpaper.sh"; }
Mod+Shift+W          { spawn-sh "~/.config/niri/scripts/WallpaperSelect.sh"; }

}


//---------------------- misc configuration ----------------------\\
screenshot-path "~/Pictures/Screenshots/screenshot_niri_%Y-%m-%d %H-%M-%S.png"
prefer-no-csd
hotkey-overlay {
    skip-at-startup
}

//---------------------- environment ----------------------\\
environment {
    QT_QPA_PLATFORMTHEME "qt5ct:qt6ct"

    ///usr/share/themes
    ///home/jgarza/.themes
    //GTK_THEME "TokyoNight"
    GTK_THEME ""
}
